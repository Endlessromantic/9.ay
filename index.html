<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bizim 9 Ayƒ±mƒ±z ü§ç</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Crimson Text', serif;
            background: linear-gradient(180deg, #0a0e27 0%, #1a1f3a 50%, #2a3f5f 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Stormy ocean background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(ellipse at 50% 100%, rgba(20, 40, 80, 0.5) 0%, transparent 50%),
                radial-gradient(ellipse at 20% 80%, rgba(10, 20, 40, 0.4) 0%, transparent 40%),
                radial-gradient(ellipse at 80% 70%, rgba(15, 30, 60, 0.3) 0%, transparent 50%);
            animation: waves 15s ease-in-out infinite;
            pointer-events: none;
            z-index: 0;
        }

        @keyframes waves {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-20px) scale(1.05); }
        }

        /* Rain */
        .rain-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .raindrop {
            position: absolute;
            width: 2px;
            height: 50px;
            background: linear-gradient(transparent, rgba(174, 194, 224, 0.6));
            animation: falling linear infinite;
        }

        @keyframes falling {
            0% {
                transform: translateY(-100px);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh);
                opacity: 0.3;
            }
        }

        /* Ship silhouette */
        .ship {
            position: fixed;
            bottom: 25%;
            left: -200px;
            width: 150px;
            height: 100px;
            z-index: 1;
            animation: shipSailing 60s linear infinite;
            opacity: 0.4;
        }

        @keyframes shipSailing {
            0% {
                left: -200px;
                transform: translateY(0);
            }
            50% {
                transform: translateY(-15px);
            }
            100% {
                left: calc(100% + 200px);
                transform: translateY(0);
            }
        }

        .ship-body {
            position: absolute;
            bottom: 0;
            left: 20px;
            width: 100px;
            height: 40px;
            background: #0a0a0a;
            clip-path: polygon(10% 100%, 0% 40%, 100% 40%, 90% 100%);
        }

        .ship-cabin {
            position: absolute;
            bottom: 35px;
            left: 40px;
            width: 40px;
            height: 25px;
            background: #0a0a0a;
        }

        .ship-mast {
            position: absolute;
            bottom: 60px;
            left: 65px;
            width: 3px;
            height: 35px;
            background: #0a0a0a;
        }

        /* Lightning flash */
        .lightning {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0);
            pointer-events: none;
            z-index: 100;
            transition: background 0.1s;
        }

        .lightning.flash {
            background: rgba(200, 220, 255, 0.4);
        }

        .container {
            position: relative;
            z-index: 2;
            max-width: 1400px;
            margin: 0 auto;
            padding: 60px 20px;
        }

        header {
            text-align: center;
            margin-bottom: 80px;
            animation: fadeInDown 1s ease-out;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 {
            font-family: 'Playfair Display', serif;
            font-size: clamp(2.5rem, 8vw, 5rem);
            font-weight: 700;
            color: #e8edf5;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.8), 0 0 30px rgba(100, 150, 200, 0.3);
            margin-bottom: 20px;
            letter-spacing: 2px;
        }

        .subtitle {
            font-size: clamp(1.2rem, 3vw, 1.8rem);
            color: rgba(232, 237, 245, 0.8);
            font-style: italic;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.8);
        }

        /* Music player */
        .music-player {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: rgba(20, 30, 50, 0.8);
            backdrop-filter: blur(10px);
            padding: 15px 25px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(100, 150, 200, 0.2);
            z-index: 1000;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .music-player:hover {
            background: rgba(30, 45, 70, 0.9);
            transform: translateY(-3px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.6);
        }

        .music-icon {
            font-size: 24px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .music-text {
            color: #e8edf5;
            font-size: 14px;
            font-weight: 600;
        }

        /* Gallery grid */
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 40px;
            padding: 20px;
        }

        .gallery-item {
            position: relative;
            aspect-ratio: 1;
            border-radius: 20px;
            overflow: hidden;
            cursor: pointer;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(100, 150, 200, 0.1);
            transition: transform 0.3s ease;
            animation: fadeInUp 0.8s ease-out backwards;
        }

        .gallery-item:nth-child(1) { animation-delay: 0.1s; }
        .gallery-item:nth-child(2) { animation-delay: 0.2s; }
        .gallery-item:nth-child(3) { animation-delay: 0.3s; }
        .gallery-item:nth-child(4) { animation-delay: 0.4s; }
        .gallery-item:nth-child(5) { animation-delay: 0.5s; }
        .gallery-item:nth-child(6) { animation-delay: 0.6s; }
        .gallery-item:nth-child(7) { animation-delay: 0.7s; }
        .gallery-item:nth-child(8) { animation-delay: 0.8s; }
        .gallery-item:nth-child(9) { animation-delay: 0.9s; }
        .gallery-item:nth-child(10) { animation-delay: 1s; }
        .gallery-item:nth-child(11) { animation-delay: 1.1s; }
        .gallery-item:nth-child(12) { animation-delay: 1.2s; }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .gallery-item:hover {
            transform: translateY(-10px) scale(1.02);
            z-index: 10;
        }

        .media-container {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .media-container img,
        .media-container video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: filter 0.4s ease, transform 0.4s ease;
        }

        /* Pixel effect */
        .gallery-item:not(:hover) .media-container img,
        .gallery-item:not(:hover) .media-container video {
            filter: contrast(1.2) brightness(0.9);
            image-rendering: pixelated;
            transform: scale(1.05);
        }

        .gallery-item:hover .media-container img,
        .gallery-item:hover .media-container video {
            filter: none;
            transform: scale(1);
        }

        /* Overlay with caption */
        .caption-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.8), transparent);
            padding: 30px 20px 20px;
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }

        .gallery-item:hover .caption-overlay {
            transform: translateY(0);
        }

        .caption-text {
            color: white;
            font-size: 18px;
            text-align: center;
            font-style: italic;
        }

        /* Video play button */
        .play-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            background: rgba(232, 237, 245, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            color: #1a1f3a;
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .gallery-item:hover .play-button {
            transform: translate(-50%, -50%) scale(1.1);
            background: white;
        }

        .video-item .play-button {
            opacity: 1;
        }

        .video-item:hover .play-button {
            opacity: 0;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            max-width: 90%;
            max-height: 90%;
            position: relative;
            animation: zoomIn 0.3s ease;
        }

        @keyframes zoomIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-content img,
        .modal-content video {
            max-width: 100%;
            max-height: 90vh;
            border-radius: 10px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .modal-close {
            position: absolute;
            top: -50px;
            right: 0;
            font-size: 40px;
            color: white;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .modal-close:hover {
            transform: rotate(90deg);
        }

        /* Modal Hearts */
        .modal-hearts {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2001;
            overflow: hidden;
        }

        .modal-heart {
            position: absolute;
            font-size: 30px;
            color: rgba(255, 255, 255, 0.8);
            animation: riseHeart 10s infinite;
            opacity: 0;
        }

        @keyframes riseHeart {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.8;
            }
            90% {
                opacity: 0.8;
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }

        /* Instructions */
        .instructions {
            text-align: center;
            margin-top: 60px;
            padding: 30px;
            background: rgba(20, 30, 50, 0.6);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(100, 150, 200, 0.2);
            color: #e8edf5;
            animation: fadeIn 2s ease;
        }

        .instructions h3 {
            font-family: 'Playfair Display', serif;
            font-size: 24px;
            margin-bottom: 15px;
        }

        .instructions p {
            font-size: 16px;
            opacity: 0.9;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .gallery {
                grid-template-columns: 1fr;
                gap: 30px;
            }

            h1 {
                font-size: 2.5rem;
            }

            .music-player {
                bottom: 20px;
                right: 20px;
                padding: 12px 20px;
            }

            .ship {
                width: 100px;
                height: 70px;
            }

            .modal-heart {
                font-size: 20px;
            }
        }

        /* 3D Character Canvas */
        #characterCanvas {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 500;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        #characterCanvas.active {
            opacity: 1;
        }

        /* Speech Bubble */
        .speech-bubble {
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translateX(-50%) scale(0);
            background: white;
            padding: 20px 30px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            z-index: 501;
            font-family: 'Crimson Text', serif;
            font-size: 24px;
            color: #1a1f3a;
            font-weight: 600;
            transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            pointer-events: none;
        }

        .speech-bubble.active {
            transform: translateX(-50%) scale(1);
        }

        .speech-bubble::after {
            content: '';
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 20px solid white;
        }

        @media (max-width: 768px) {
            .speech-bubble {
                font-size: 18px;
                padding: 15px 20px;
                top: 15%;
            }
        }
    </style>
</head>
<body>
    <!-- Lightning effect -->
    <div class="lightning" id="lightning"></div>

    <!-- Ship -->
    <div class="ship">
        <div class="ship-mast"></div>
        <div class="ship-cabin"></div>
        <div class="ship-body"></div>
    </div>

    <!-- Rain -->
    <div class="rain-container" id="rainContainer"></div>

    <!-- 3D Character Canvas -->
    <canvas id="characterCanvas"></canvas>
    
    <!-- Speech Bubble -->
    <div class="speech-bubble" id="speechBubble">Pardon, ge√ßebilir miyim? </div>

    <!-- Music player -->
    <div class="music-player" onclick="toggleMusic()">
        <span class="music-icon" id="musicIcon">üéµ</span>
        <span class="music-text" id="musicText">M√ºzik √áal</span>
    </div>

    <audio id="bgMusic" loop>
        <source src="/music.mp3" type="audio/mpeg">
    </audio>

    <div class="container">
        <header>
            <h1>Bizim 9 Ayƒ±mƒ±z ü§ç</h1>
            <p class="subtitle">Al sana g√ºld√ºƒü√ºm√ºz hikaye üòÇüòÇüòÇüòÇ</p>
        </header>

        <div class="gallery">
            <!-- Foto 1 -->
            <div class="gallery-item" onclick="openModal(this)">
                <div class="media-container">
                    <img src="img1.jpg" alt="Memory 1">
                    <div class="caption-overlay">
                        <p class="caption-text">üíï</p>
                    </div>
                </div>
            </div>

            <!-- Foto 2 -->
            <div class="gallery-item" onclick="openModal(this)">
                <div class="media-container">
                    <img src="img2.jpg" alt="Memory 2">
                    <div class="caption-overlay">
                        <p class="caption-text">G√ºl√º≈üe bak yerim üòÑ</p>
                    </div>
                </div>
            </div>

            <!-- Video 1 -->
            <div class="gallery-item video-item" onclick="openModal(this)">
                <div class="media-container">
                    <video muted>
                        <source src="vi1.mp4" type="video/mp4">
                    </video>
                    <div class="play-button">‚ñ∂</div>
                    <div class="caption-overlay">
                        <p class="caption-text">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</p>
                    </div>
                </div>
            </div>

            <!-- Foto 3 -->
            <div class="gallery-item" onclick="openModal(this)">
                <div class="media-container">
                    <img src="img3.jpg" alt="Memory 3">
                    <div class="caption-overlay">
                        <p class="caption-text">üïäÔ∏èüïäÔ∏èüïäÔ∏è</p>
                    </div>
                </div>
            </div>

            <div class="gallery-item video-item" onclick="openModal(this)">
                <div class="media-container">
                    <video muted>
                        <source src="vi3.mp4" type="video/mp4">
                    </video>
                    <div class="play-button">‚ñ∂</div>
                    <div class="caption-overlay">
                        <p class="caption-text">ü´ñü´ñü´ñü´ñ</p>
                    </div>
                </div>
            </div>

            <!-- Foto 4 -->
            <div class="gallery-item" onclick="openModal(this)">
                <div class="media-container">
                    <img src="img4.jpg" alt="Memory 4">
                    <div class="caption-overlay">
                        <p class="caption-text"> Manzaranƒ±n g√ºzelliƒüi ....</p>
                    </div>
                </div>
            </div>

            <!-- Video 2 -->
            <div class="gallery-item video-item" onclick="openModal(this)">
                <div class="media-container">
                    <video muted>
                        <source src="vi2.mp4" type="video/mp4">
                    </video>
                    <div class="play-button">‚ñ∂</div>
                    <div class="caption-overlay">
                        <p class="caption-text"></p>
                    </div>
                </div>
            </div>

            <!-- Foto 5 -->
            <div class="gallery-item" onclick="openModal(this)">
                <div class="media-container">
                    <img src="img5.jpg" alt="Memory 5">
                    <div class="caption-overlay">
                        <p class="caption-text">Ve biz üí´</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="instructions">
            <h3>Sihir i√ßin m√ºziƒüe tƒ±klamayƒ± unutmaaa ‚ú®</h3>
            <p>Her fotoƒürafƒ±n √ºzerine gel ve pixellerden ger√ßek anƒ±ya d√∂n√º≈ümesini izle! üé®<br>
             üéµ</p>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal" id="modal" onclick="closeModal()">
        <div class="modal-close">√ó</div>
        <div class="modal-hearts" id="modalHearts"></div>
        <div class="modal-content" id="modalContent" onclick="event.stopPropagation()">
        </div>
    </div>

    <script>
        // ============ RAIN EFFECT ============
        function createRain() {
            const rainContainer = document.getElementById('rainContainer');
            for (let i = 0; i < 100; i++) {
                const drop = document.createElement('div');
                drop.className = 'raindrop';
                drop.style.left = Math.random() * 100 + '%';
                drop.style.animationDuration = (Math.random() * 0.5 + 0.5) + 's';
                drop.style.animationDelay = Math.random() * 2 + 's';
                rainContainer.appendChild(drop);
            }
        }

        // ============ LIGHTNING EFFECT ============
        function triggerLightning() {
            const lightning = document.getElementById('lightning');
            lightning.classList.add('flash');
            setTimeout(() => {
                lightning.classList.remove('flash');
            }, 100);
            
            const nextFlash = Math.random() * 1000 + 1000;
            setTimeout(triggerLightning, nextFlash);
        }

        // ============ MODAL HEARTS ============
        let heartInterval;
        
        function createModalHeart() {
            const heartsContainer = document.getElementById('modalHearts');
            const heart = document.createElement('div');
            heart.className = 'modal-heart';
            heart.innerHTML = 'ü§ç';
            heart.style.left = Math.random() * 100 + '%';
            heart.style.animationDelay = Math.random() * 2 + 's';
            heart.style.animationDuration = (Math.random() * 5 + 8) + 's';
            heartsContainer.appendChild(heart);
            
            setTimeout(() => heart.remove(), 13000);
        }

        function startModalHearts() {
            const heartsContainer = document.getElementById('modalHearts');
            heartsContainer.innerHTML = '';
            
            // Create initial hearts
            for(let i = 0; i < 8; i++) {
                setTimeout(createModalHeart, i * 200);
            }
            
            // Continue creating hearts
            heartInterval = setInterval(createModalHeart, 1500);
        }

        function stopModalHearts() {
            if (heartInterval) {
                clearInterval(heartInterval);
            }
            const heartsContainer = document.getElementById('modalHearts');
            heartsContainer.innerHTML = '';
        }

        // ============ 3D CHARACTER SETUP ============
        let scene, camera, renderer, character, coupleGroup;
        let isCharacterActive = false;
        let walkProgress = 0;

        function init3DCharacter() {
            const canvas = document.getElementById('characterCanvas');
            scene = new THREE.Scene();
            
            camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 1.5, 5);
            
            renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true, antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setClearColor(0x000000, 0);
            
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(5, 10, 5);
            scene.add(directionalLight);
            
            createCouple();
            createCharacter();
            
            window.addEventListener('resize', onWindowResize);
        }

        function createCouple() {
            coupleGroup = new THREE.Group();
            
            const skinColor = 0xffd7b5;
            const darkSkinColor = 0xd4a373;
            
            const boy = new THREE.Group();
            
            const boyHeadGeo = new THREE.SphereGeometry(0.25, 32, 32);
            const boyHeadMat = new THREE.MeshLambertMaterial({ color: darkSkinColor });
            const boyHead = new THREE.Mesh(boyHeadGeo, boyHeadMat);
            boyHead.position.y = 1.4;
            boy.add(boyHead);
            
            const boyHairGeo = new THREE.SphereGeometry(0.27, 32, 32);
            const boyHairMat = new THREE.MeshLambertMaterial({ color: 0x2c1810 });
            const boyHair = new THREE.Mesh(boyHairGeo, boyHairMat);
            boyHair.position.y = 1.5;
            boyHair.scale.set(1, 0.8, 1);
            boy.add(boyHair);
            
            const eyeGeo = new THREE.SphereGeometry(0.04, 16, 16);
            const eyeMat = new THREE.MeshLambertMaterial({ color: 0x000000 });
            
            const boyLeftEye = new THREE.Mesh(eyeGeo, eyeMat);
            boyLeftEye.position.set(-0.08, 1.45, 0.2);
            boy.add(boyLeftEye);
            
            const boyRightEye = new THREE.Mesh(eyeGeo, eyeMat);
            boyRightEye.position.set(0.08, 1.45, 0.2);
            boy.add(boyRightEye);
            
            const smileCurve = new THREE.EllipseCurve(0, 0, 0.08, 0.04, 0, Math.PI, false, 0);
            const smilePoints = smileCurve.getPoints(20);
            const smileGeo = new THREE.BufferGeometry().setFromPoints(smilePoints);
            const smileMat = new THREE.LineBasicMaterial({ color: 0x000000 });
            const boySmile = new THREE.Line(smileGeo, smileMat);
            boySmile.position.set(0, 1.32, 0.23);
            boy.add(boySmile);
            
            const boyJacketGeo = new THREE.CylinderGeometry(0.35, 0.4, 0.7, 32);
            const boyJacketMat = new THREE.MeshLambertMaterial({ color: 0x2c5aa0 });
            const boyJacket = new THREE.Mesh(boyJacketGeo, boyJacketMat);
            boyJacket.position.y = 0.7;
            boy.add(boyJacket);
            
            const armGeo = new THREE.CylinderGeometry(0.07, 0.07, 0.55, 16);
            const boyArmMat = new THREE.MeshLambertMaterial({ color: 0x2c5aa0 });
            
            const boyLeftArm = new THREE.Mesh(armGeo, boyArmMat);
            boyLeftArm.position.set(-0.35, 0.75, 0);
            boyLeftArm.rotation.z = 0.5;
            boy.add(boyLeftArm);
            boy.leftArm = boyLeftArm;
            
            const boyRightArm = new THREE.Mesh(armGeo, boyArmMat);
            boyRightArm.position.set(0.42, 0.75, 0);
            boyRightArm.rotation.z = -0.8;
            boy.add(boyRightArm);
            boy.rightArm = boyRightArm;
            
            const legGeo = new THREE.CylinderGeometry(0.09, 0.08, 0.65, 16);
            const pantsMat = new THREE.MeshLambertMaterial({ color: 0x1a1a1a });
            
            const boyLeftLeg = new THREE.Mesh(legGeo, pantsMat);
            boyLeftLeg.position.set(-0.12, 0, 0);
            boy.add(boyLeftLeg);
            
            const boyRightLeg = new THREE.Mesh(legGeo, pantsMat);
            boyRightLeg.position.set(0.12, 0, 0);
            boy.add(boyRightLeg);
            
            boy.position.x = -0.35;
            coupleGroup.add(boy);
            coupleGroup.boy = boy;
            
            const girl = new THREE.Group();
            
            const girlHeadGeo = new THREE.SphereGeometry(0.23, 32, 32);
            const girlHeadMat = new THREE.MeshLambertMaterial({ color: skinColor });
            const girlHead = new THREE.Mesh(girlHeadGeo, girlHeadMat);
            girlHead.position.y = 1.35;
            girl.add(girlHead);
            
            const girlHairGeo = new THREE.SphereGeometry(0.28, 32, 32);
            const girlHairMat = new THREE.MeshLambertMaterial({ color: 0x5c3317 });
            const girlHair = new THREE.Mesh(girlHairGeo, girlHairMat);
            girlHair.position.y = 1.45;
            girlHair.scale.set(1.1, 1.3, 1.05);
            girl.add(girlHair);
            
            const girlBangsGeo = new THREE.SphereGeometry(0.15, 16, 16);
            const girlBangs = new THREE.Mesh(girlBangsGeo, girlHairMat);
            girlBangs.position.set(0, 1.42, 0.2);
            girlBangs.scale.set(1.3, 0.5, 0.8);
            girl.add(girlBangs);
            
            const girlSideHairL = new THREE.Mesh(girlBangsGeo, girlHairMat);
            girlSideHairL.position.set(-0.22, 1.2, 0.05);
            girlSideHairL.scale.set(0.6, 1.5, 0.7);
            girl.add(girlSideHairL);
            
            const girlSideHairR = new THREE.Mesh(girlBangsGeo, girlHairMat);
            girlSideHairR.position.set(0.22, 1.2, 0.05);
            girlSideHairR.scale.set(0.6, 1.5, 0.7);
            girl.add(girlSideHairR);
            
            const girlLeftEye = new THREE.Mesh(eyeGeo, eyeMat);
            girlLeftEye.position.set(-0.08, 1.38, 0.2);
            girl.add(girlLeftEye);
            
            const girlRightEye = new THREE.Mesh(eyeGeo, eyeMat);
            girlRightEye.position.set(0.08, 1.38, 0.2);
            girl.add(girlRightEye);
            
            const girlSmile = new THREE.Line(smileGeo, smileMat);
            girlSmile.position.set(0, 1.27, 0.21);
            girl.add(girlSmile);
            
            const girlJacketGeo = new THREE.CylinderGeometry(0.32, 0.38, 0.65, 32);
            const girlJacketMat = new THREE.MeshLambertMaterial({ color: 0xff85a8 });
            const girlJacket = new THREE.Mesh(girlJacketGeo, girlJacketMat);
            girlJacket.position.y = 0.65;
            girl.add(girlJacket);
            
            const girlArmMat = new THREE.MeshLambertMaterial({ color: 0xff85a8 });
            
            const girlLeftArm = new THREE.Mesh(armGeo, girlArmMat);
            girlLeftArm.position.set(-0.4, 0.7, 0);
            girlLeftArm.rotation.z = 0.8;
            girl.add(girlLeftArm);
            girl.leftArm = girlLeftArm;
            
            const girlRightArm = new THREE.Mesh(armGeo, girlArmMat);
            girlRightArm.position.set(0.32, 0.7, 0);
            girlRightArm.rotation.z = -0.4;
            girl.add(girlRightArm);
            girl.rightArm = girlRightArm;
            
            const girlLeftLeg = new THREE.Mesh(legGeo, pantsMat);
            girlLeftLeg.position.set(-0.11, -0.05, 0);
            girl.add(girlLeftLeg);
            
            const girlRightLeg = new THREE.Mesh(legGeo, pantsMat);
            girlRightLeg.position.set(0.11, -0.05, 0);
            girl.add(girlRightLeg);
            
            girl.position.x = 0.35;
            coupleGroup.add(girl);
            coupleGroup.girl = girl;
            
            coupleGroup.position.set(0, -0.5, 0);
            coupleGroup.scale.set(0, 0, 0);
            scene.add(coupleGroup);
        }

        function createCharacter() {
            character = new THREE.Group();
            
            const skinColor = 0xffd7b5;
            const hairColor = 0x4a2511;
            const dressColor = 0xff69b4;
            
            const headGeometry = new THREE.SphereGeometry(0.3, 32, 32);
            const headMaterial = new THREE.MeshLambertMaterial({ color: skinColor });
            const head = new THREE.Mesh(headGeometry, headMaterial);
            head.position.y = 1.5;
            character.add(head);
            
            const hairGeometry = new THREE.SphereGeometry(0.35, 32, 32);
            const hairMaterial = new THREE.MeshLambertMaterial({ color: hairColor });
            const hair = new THREE.Mesh(hairGeometry, hairMaterial);
            hair.position.y = 1.65;
            hair.scale.set(1.1, 1.3, 1.05);
            character.add(hair);
            
            const bangsGeometry = new THREE.SphereGeometry(0.2, 16, 16);
            const bangs = new THREE.Mesh(bangsGeometry, hairMaterial);
            bangs.position.set(0, 1.6, 0.25);
            bangs.scale.set(1.3, 0.6, 0.8);
            character.add(bangs);
            
            const sideHairLeft = new THREE.Mesh(bangsGeometry, hairMaterial);
            sideHairLeft.position.set(-0.28, 1.5, 0.1);
            sideHairLeft.scale.set(0.6, 1.2, 0.7);
            character.add(sideHairLeft);
            
            const sideHairRight = new THREE.Mesh(bangsGeometry, hairMaterial);
            sideHairRight.position.set(0.28, 1.5, 0.1);
            sideHairRight.scale.set(0.6, 1.2, 0.7);
            character.add(sideHairRight);
            
            const ponytailGeometry = new THREE.SphereGeometry(0.18, 16, 16);
            const ponytail = new THREE.Mesh(ponytailGeometry, hairMaterial);
            ponytail.position.set(0, 1.55, -0.3);
            ponytail.scale.set(0.9, 1.8, 0.9);
            character.add(ponytail);
            character.ponytail = ponytail;
            
            const eyeGeometry = new THREE.SphereGeometry(0.05, 16, 16);
            const eyeMaterial = new THREE.MeshLambertMaterial({ color: 0x000000 });
            
            const leftEye = new THREE.Mesh(eyeGeometry, eyeMaterial);
            leftEye.position.set(-0.1, 1.55, 0.25);
            character.add(leftEye);
            
            const rightEye = new THREE.Mesh(eyeGeometry, eyeMaterial);
            rightEye.position.set(0.1, 1.55, 0.25);
            character.add(rightEye);
            
            const smileCurve = new THREE.EllipseCurve(0, 0, 0.1, 0.05, 0, Math.PI, false, 0);
            const smilePoints = smileCurve.getPoints(20);
            const smileGeometry = new THREE.BufferGeometry().setFromPoints(smilePoints);
            const smileMaterial = new THREE.LineBasicMaterial({ color: 0x000000, linewidth: 2 });
            const smile = new THREE.Line(smileGeometry, smileMaterial);
            smile.position.set(0, 1.4, 0.28);
            character.add(smile);
            
            const bodyGeometry = new THREE.ConeGeometry(0.4, 0.8, 32);
            const bodyMaterial = new THREE.MeshLambertMaterial({ color: dressColor });
            const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
            body.position.y = 0.7;
            character.add(body);
            
            const armGeometry = new THREE.CylinderGeometry(0.08, 0.08, 0.6, 16);
            const armMaterial = new THREE.MeshLambertMaterial({ color: skinColor });
            
            const leftArm = new THREE.Mesh(armGeometry, armMaterial);
            leftArm.position.set(-0.35, 0.9, 0);
            leftArm.rotation.z = 0.3;
            character.add(leftArm);
            character.leftArm = leftArm;
            
            const rightArm = new THREE.Mesh(armGeometry, armMaterial);
            rightArm.position.set(0.35, 0.9, 0);
            rightArm.rotation.z = -0.3;
            character.add(rightArm);
            character.rightArm = rightArm;
            
            const legGeometry = new THREE.CylinderGeometry(0.1, 0.08, 0.7, 16);
            const legMaterial = new THREE.MeshLambertMaterial({ color: skinColor });
            
            const leftLeg = new THREE.Mesh(legGeometry, legMaterial);
            leftLeg.position.set(-0.15, -0.05, 0);
            character.add(leftLeg);
            character.leftLeg = leftLeg;
            
            const rightLeg = new THREE.Mesh(legGeometry, legMaterial);
            rightLeg.position.set(0.15, -0.05, 0);
            character.add(rightLeg);
            character.rightLeg = rightLeg;
            
            character.position.set(-8, -0.5, 0);
            character.rotation.y = Math.PI / 6;
            
            scene.add(character);
        }

        let walkState = 'couple_appearing';
        let waitTimer = 0;
        let coupleAppearProgress = 0;
        let bubbleShown = false;

        function animateCharacter() {
            if (!isCharacterActive) return;
            
            const time = Date.now() * 0.001;
            const bubble = document.getElementById('speechBubble');
            
            if (walkState === 'couple_appearing') {
                coupleAppearProgress += 0.02;
                const scale = Math.min(coupleAppearProgress, 1);
                coupleGroup.scale.set(scale, scale, scale);
                
                if (coupleAppearProgress >= 1) {
                    walkState = 'couple_idle';
                    waitTimer = Date.now();
                }
            }
            else if (walkState === 'couple_idle') {
                const breathe = 1 + Math.sin(time * 2) * 0.015;
                coupleGroup.scale.set(breathe, breathe, breathe);
                coupleGroup.rotation.y = Math.sin(time * 0.3) * 0.03;
                
                if (Date.now() - waitTimer > 3000) {
                    walkState = 'girl_walking';
                    walkProgress = 0;
                    bubbleShown = false;
                }
            }
            else if (walkState === 'girl_walking') {
                const breathe = 1 + Math.sin(time * 2) * 0.015;
                coupleGroup.scale.set(breathe, breathe, breathe);
                coupleGroup.rotation.y = Math.sin(time * 0.3) * 0.03;
                
                if (!bubbleShown) {
                    bubble.classList.add('active');
                    bubbleShown = true;
                }
                
                walkProgress += 0.008;
                character.position.x = -8 + (walkProgress * 8);
                
                const walkCycle = Math.sin(walkProgress * 50) * 0.3;
                character.leftLeg.rotation.x = walkCycle;
                character.rightLeg.rotation.x = -walkCycle;
                character.leftArm.rotation.x = -walkCycle * 0.5;
                character.rightArm.rotation.x = walkCycle * 0.5;
                
                if (character.ponytail) {
                    character.ponytail.rotation.x = Math.sin(walkProgress * 50) * 0.2;
                }
                
                character.position.y = -0.5 + Math.abs(Math.sin(walkProgress * 50)) * 0.08;
                
                if (character.position.x >= -0.5) {
                    walkState = 'girl_waiting';
                    waitTimer = Date.now();
                    character.position.x = -0.5;
                    character.rotation.y = Math.PI / 8;
                }
            } 
            else if (walkState === 'girl_waiting') {
                const breathe = 1 + Math.sin(time * 2) * 0.015;
                coupleGroup.scale.set(breathe, breathe, breathe);
                coupleGroup.rotation.y = Math.sin(time * 0.3) * 0.03;
                
                character.position.y = -0.5 + Math.sin(time * 2) * 0.02;
                character.rotation.y = Math.PI / 8;
                character.scale.y = 1 + Math.sin(time * 2) * 0.02;
                
                character.leftArm.rotation.z = 0.3 + Math.sin(time * 0.8) * 0.1;
                character.rightArm.rotation.z = -0.3 - Math.sin(time * 0.8) * 0.1;
                
                if (character.ponytail) {
                    character.ponytail.rotation.x = Math.sin(time * 1.5) * 0.1;
                }
                
                if (Date.now() - waitTimer > 2000) {
                    walkState = 'girl_walking_out';
                    walkProgress = 0;
                }
            }
            else if (walkState === 'girl_walking_out') {
                const breathe = 1 + Math.sin(time * 2) * 0.015;
                coupleGroup.scale.set(breathe, breathe, breathe);
                coupleGroup.rotation.y = Math.sin(time * 0.3) * 0.03;
                
                walkProgress += 0.008;
                character.position.x = -0.5 + (walkProgress * 8.5);
                character.rotation.y = -Math.PI / 8;
                
                const walkCycle = Math.sin(walkProgress * 50) * 0.3;
                character.leftLeg.rotation.x = walkCycle;
                character.rightLeg.rotation.x = -walkCycle;
                character.leftArm.rotation.x = -walkCycle * 0.5;
                character.rightArm.rotation.x = walkCycle * 0.5;
                
                if (character.ponytail) {
                    character.ponytail.rotation.x = Math.sin(walkProgress * 50) * 0.2;
                }
                
                character.position.y = -0.5 + Math.abs(Math.sin(walkProgress * 50)) * 0.08;
                
                if (character.position.x >= 8) {
                    character.position.x = -8;
                    character.rotation.y = Math.PI / 6;
                    walkProgress = 0;
                    coupleAppearProgress = 0;
                    coupleGroup.scale.set(0, 0, 0);
                    walkState = 'couple_appearing';
                    bubble.classList.remove('active');
                    bubbleShown = false;
                }
            }
            
            renderer.render(scene, camera);
            requestAnimationFrame(animateCharacter);
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function showCharacter() {
            const canvas = document.getElementById('characterCanvas');
            canvas.classList.add('active');
            isCharacterActive = true;
            animateCharacter();
        }

        function hideCharacter() {
            const canvas = document.getElementById('characterCanvas');
            const bubble = document.getElementById('speechBubble');
            
            canvas.classList.remove('active');
            bubble.classList.remove('active');
            isCharacterActive = false;
            walkProgress = 0;
            coupleAppearProgress = 0;
            bubbleShown = false;
            walkState = 'couple_appearing';
            if (character) {
                character.position.set(-8, -0.5, 0);
                character.rotation.y = Math.PI / 6;
            }
            if (coupleGroup) {
                coupleGroup.scale.set(0, 0, 0);
            }
        }

        // Initialize
        window.addEventListener('load', () => {
            init3DCharacter();
            createRain();
            setTimeout(triggerLightning, 1000);
        });

        // Music player
        let isPlaying = false;
        const music = document.getElementById('bgMusic');
        
        function toggleMusic() {
            if (isPlaying) {
                music.pause();
                document.getElementById('musicIcon').innerHTML = 'üéµ';
                document.getElementById('musicText').innerHTML = 'M√ºzik √áal';
                hideCharacter();
            } else {
                music.play();
                document.getElementById('musicIcon').innerHTML = 'üé∂';
                document.getElementById('musicText').innerHTML = 'M√ºzik Durdur';
                showCharacter();
            }
            isPlaying = !isPlaying;
        }

        // Modal functions
        function openModal(element) {
            const modal = document.getElementById('modal');
            const modalContent = document.getElementById('modalContent');
            const mediaContainer = element.querySelector('.media-container');
            
            modalContent.innerHTML = '';
            
            const media = mediaContainer.querySelector('img, video').cloneNode(true);
            
            if (media.tagName === 'VIDEO') {
                media.controls = true;
                media.muted = false;
                media.play();
            }
            
            modalContent.appendChild(media);
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Start hearts
            startModalHearts();
        }

        function closeModal() {
            const modal = document.getElementById('modal');
            const video = modal.querySelector('video');
            if (video) {
                video.pause();
            }
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
            
            // Stop hearts
            stopModalHearts();
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeModal();
            }
        });

        window.addEventListener('scroll', () => {
            const scrolled = window.pageYOffset;
            document.querySelectorAll('.gallery-item').forEach((item, index) => {
                const itemTop = item.offsetTop;
                const itemHeight = item.offsetHeight;
                const windowHeight = window.innerHeight;
                
                if (scrolled + windowHeight > itemTop && scrolled < itemTop + itemHeight) {
                    item.style.opacity = '1';
                }
            });
        });
    </script>
</body>
</html>